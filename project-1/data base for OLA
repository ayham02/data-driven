
CREATE DATABASE Ola;
USE Ola;


CREATE TABLE Customer (
    CustomerID INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(50),
    Email VARCHAR(50) UNIQUE,
    PhoneNumber VARCHAR(15) UNIQUE,
    Address VARCHAR(100)
);


CREATE TABLE Driver (
    DriverID INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(50),
    Email VARCHAR(50) UNIQUE,
    PhoneNumber VARCHAR(15) UNIQUE,
    Address VARCHAR(100),
    LicenseNo VARCHAR(10) UNIQUE
);


CREATE TABLE Vehicle (
    VehicleID INT AUTO_INCREMENT PRIMARY KEY,
    DriverID INT,
    Model VARCHAR(50),
    License_id VARCHAR(20) UNIQUE,
    Color VARCHAR(20),
    FOREIGN KEY (DriverID) REFERENCES Driver(DriverID)
);
  
  

CREATE TABLE Ride (
    RideID INT AUTO_INCREMENT PRIMARY KEY,
    CustomerID INT,
    DriverID INT,
    PICKUP VARCHAR(100),
    DROP_OFF VARCHAR(100), 
    Distance FLOAT,
    Fare FLOAT,
    RIDEDATE DATE,
    FOREIGN KEY (CustomerID) REFERENCES Customer(CustomerID),
    FOREIGN KEY (DriverID) REFERENCES Driver(DriverID)
);


CREATE TABLE Payment (
    PaymentID INT AUTO_INCREMENT PRIMARY KEY,
    RideID INT,
    Amount FLOAT,
    PaymentMethod VARCHAR(20),
    PaymentDate DATETIME,
    UPI_ID VARCHAR(50),
    Cash BOOLEAN,  
    Date DATE,
    FOREIGN KEY (RideID) REFERENCES Ride(RideID)
);



CREATE TABLE Feedback (
    FeedbackID INT AUTO_INCREMENT PRIMARY KEY,
    RideID INT,
    CustomerID INT,
    Rating INT CHECK (Rating BETWEEN 1 AND 5),
    Comments TEXT,
    FeedbackDate DATETIME,
    FOREIGN KEY (CustomerID) REFERENCES Customer(CustomerID),
    FOREIGN KEY (DriverID) REFERENCES Driver(DriverID)
);

CREATE TABLE CustomerRide (
    Customer_ID INT,
    Ride_ID INT,
    FOREIGN KEY (Customer_ID) REFERENCES Customer(CustomerID),
    FOREIGN KEY (Ride_ID) REFERENCES Ride(RideID)
);

CREATE TABLE driver_vehicle (
    driver_id INT,
    vehicle_id INT,
    FOREIGN KEY (driver_id) REFERENCES Driver(DriverID),
    FOREIGN KEY (vehicle_id) REFERENCES Vehicle(VehicleID)
);

CREATE TABLE RideFeedback (
    RideID INT,
    FeedbackID INT AUTO_INCREMENT PRIMARY KEY,
    PRIMARY KEY (RideID, FeedbackID),
    FOREIGN KEY (RideID) REFERENCES Ride(RideID),
    FOREIGN KEY (FeedbackID) REFERENCES Feedback(FeedbackID)
);
CREATE TABLE RideFeedback (
    RideID INT,
    FeedbackID INT AUTO_INCREMENT PRIMARY KEY,
    FOREIGN KEY (RideID) REFERENCES Ride(RideID),
    FOREIGN KEY (FeedbackID) REFERENCES Feedback(FeedbackID)
);
-- sample values

INSERT INTO Ride (CustomerID, DriverID, PICKUP, DROP_OFF, Distance, Fare, RIDEDATE)
VALUES (1, 1, '123 Main St', '456 Elm St', 10.5, 25.00, '2024-06-22');


INSERT INTO Payment (RideID, Amount, PaymentMethod, PaymentDate, UPI_ID, Cash, Date)
VALUES (1, 25.00, 'Credit Card', '2024-06-22 12:00:00', 'john.doe@upi', FALSE, '2024-06-22');

INSERT INTO Feedback (RideID, CustomerID, Rating, Comments, FeedbackDate)
VALUES (1, 1, 4, 'Great ride!', '2024-06-22 13:00:00');


INSERT INTO CustomerRide (Customer_ID, Ride_ID)
VALUES (1, 1);

INSERT INTO driver_vehicle (driver_id, vehicle_id)
VALUES (1, 1);


INSERT INTO RideFeedback (RideID)
VALUES (1);
